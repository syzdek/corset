#
#   Corset Firewall
#   Copyright (C) 2021 David M. Syzdek <david@syzdek.net>.
#   All rights reserved.
#
#   Redistribution and use in source and binary forms, with or without
#   modification, are permitted provided that the following conditions are
#   met:
#
#       * Redistributions of source code must retain the above copyright
#          notice, this list of conditions and the following disclaimer.
#       * Redistributions in binary form must reproduce the above copyright
#          notice, this list of conditions and the following disclaimer in the
#          documentation and/or other materials provided with the distribution.
#       * Neither the name of David M. Syzdek nor the
#          names of its contributors may be used to endorse or promote products
#          derived from this software without specific prior written permission.
#
#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
#   IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
#   THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
#   PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL DAVID M SYZDEK BE LIABLE FOR
#   ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
#   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#   SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
#   CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
#   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
#   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
#   SUCH DAMAGE.
#
#
#   mockup of configuration using Juniper's JunOS Like configuration
#

foreground false;
pidfile "/var/run/coreset/corset.pid";
socket "/var/run/coreset/corset.sock";
module_path "/usr/libexec/corset/modules";

load_modules {
   mod_syslog {
      module_path "/usr/libexec/corset/modules";
   }
   mod_nfacct {}
   mod_nfqueue {}
   mod_radius {}
}

# a module has one ore more traits:
#    log      - provides logging functionality
#    acct-src - generates accounting information
#    acct-dst - stores accounting information
#    authen   - provides authentication
#    author   - provides authorization
#    cache    - provides cache
#    trigger  - generates event triggers
modules {
   mod_syslog "syslog" {
      traits [ logging ];
      facility    "daemon";
      log_upto    "notice";
   }
   mod_nfacct "acct_wan" {
      traits [ acct-src ];
      default_interface "eth0.1996";
   }
   mod_nfqueue "subscribers" {
      traits [ trigger ];
      queue        100;
   }
   /* Radius server for end  users */
   mod_radius "userRadius" {
      traits  [ "authen", "author", "acct-dst" ];
      servers {
         raduser148.anc.foo.org {
            secret  "asdqweasdasdqweads";
         }
         raduser231.sea.foo.org {
            secret "pqwefjasdqwenneead";
         }
      }
   }
   /* Radius server for admin users */
   mod_radius "adminRadius" {
      traits      [ "authen", "author", "acct-dst" ];
      servers {
         raduser215.lax.foo.org {
            secret "llqifnasdqkkqwedha";
         }
         raduser228.pns.foo.org {
            secret "madasdyhdhasdkqwek";
         }
      }
   }
   mod_redis "redisCache" {
      traits      [ "cache" ];
      server      "127.0.0.1";
      port        6379;
      timeout     10;
      cachettl    600;
   }
}

